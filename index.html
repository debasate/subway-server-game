<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Subway Server Game</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
</head>

<body>
    <!-- Login Screen -->
    <div id="login-screen">
        <div class="auth-container">
            <div class="game-logo">
                <h1>🚇 Subway Server Game 🚇</h1>
                <div class="version-badge">v3.2.0</div>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">🔑 Inloggen</button>
                <button class="auth-tab" data-tab="register">📝 Registreren</button>
                <button class="auth-tab" data-tab="guest">👤 Gast Spelen</button>
            </div>

            <!-- Login Form -->
            <div id="login-form" class="auth-form active">
                <h2>Welkom Terug!</h2>
                <p class="auth-subtitle">Log in om je voortgang te bewaren</p>
                
                <div class="input-group">
                    <label for="login-username">Gebruikersnaam</label>
                    <input type="text" id="login-username" placeholder="Voer je gebruikersnaam in" autocomplete="username">
                </div>
                
                <div class="input-group">
                    <label for="login-password">Wachtwoord</label>
                    <input type="password" id="login-password" placeholder="Voer je wachtwoord in" autocomplete="current-password">
                </div>
                
                <div class="auth-options">
                    <label class="checkbox-wrapper">
                        <input type="checkbox" id="remember-me">
                        <span class="checkmark"></span>
                        Onthoud mij
                    </label>
                </div>
                
                <button id="login-btn" class="auth-btn primary">
                    <span class="btn-icon">🔑</span>
                    Inloggen
                </button>
                
                <div class="auth-divider">
                    <span>of</span>
                </div>
                
                <button id="demo-login-btn" class="auth-btn secondary">
                    <span class="btn-icon">⚡</span>
                    Demo Account (admin/admin)
                </button>
            </div>

            <!-- Register Form -->
            <div id="register-form" class="auth-form">
                <h2>Account Aanmaken</h2>
                <p class="auth-subtitle">Maak een account om je scores te bewaren</p>
                
                <div class="input-group">
                    <label for="register-username">Gebruikersnaam</label>
                    <input type="text" id="register-username" placeholder="Kies een gebruikersnaam (3-20 tekens)" autocomplete="username">
                    <div class="input-feedback" id="username-feedback"></div>
                </div>
                
                <div class="input-group">
                    <label for="register-email">Email (optioneel)</label>
                    <input type="email" id="register-email" placeholder="je.email@voorbeeld.com" autocomplete="email">
                </div>
                
                <div class="input-group">
                    <label for="register-password">Wachtwoord</label>
                    <input type="password" id="register-password" placeholder="Minimaal 6 tekens" autocomplete="new-password">
                    <div class="password-strength" id="password-strength">
                        <div class="strength-bar">
                            <div class="strength-fill"></div>
                        </div>
                        <span class="strength-text">Voer een wachtwoord in</span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="register-password-confirm">Bevestig Wachtwoord</label>
                    <input type="password" id="register-password-confirm" placeholder="Herhaal je wachtwoord" autocomplete="new-password">
                    <div class="input-feedback" id="password-feedback"></div>
                </div>
                
                <div class="auth-options">
                    <label class="checkbox-wrapper">
                        <input type="checkbox" id="terms-agree" required>
                        <span class="checkmark"></span>
                        Ik ga akkoord met de voorwaarden
                    </label>
                </div>
                
                <button id="register-btn" class="auth-btn primary" disabled>
                    <span class="btn-icon">📝</span>
                    Account Aanmaken
                </button>
            </div>

            <!-- Guest Form -->
            <div id="guest-form" class="auth-form">
                <h2>Spelen als Gast</h2>
                <p class="auth-subtitle">Speel zonder account (voortgang wordt niet bewaard)</p>
                
                <div class="guest-features">
                    <div class="feature-list">
                        <div class="feature-item">✅ Alle game modes beschikbaar</div>
                        <div class="feature-item">✅ Lokale high scores</div>
                        <div class="feature-item">❌ Geen cloud save</div>
                        <div class="feature-item">❌ Geen global leaderboards</div>
                        <div class="feature-item">❌ Geen cross-device sync</div>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="guest-nickname">Nickname (optioneel)</label>
                    <input type="text" id="guest-nickname" placeholder="Voer een nickname in" maxlength="15">
                </div>
                
                <button id="guest-play-btn" class="auth-btn primary">
                    <span class="btn-icon">🎮</span>
                    Spelen als Gast
                </button>
                
                <p class="guest-disclaimer">
                    💡 <strong>Tip:</strong> Maak een account om je voortgang te bewaren!
                </p>
            </div>

            <!-- Loading State -->
            <div id="auth-loading" class="auth-loading" style="display: none;">
                <div class="loading-spinner"></div>
                <p>Verbinden...</p>
            </div>

            <!-- Error Messages -->
            <div id="auth-error" class="auth-message error" style="display: none;">
                <span class="message-icon">❌</span>
                <span class="message-text"></span>
            </div>

            <!-- Success Messages -->
            <div id="auth-success" class="auth-message success" style="display: none;">
                <span class="message-icon">✅</span>
                <span class="message-text"></span>
            </div>
        </div>

        <!-- Background Animation -->
        <div class="auth-background">
            <div class="floating-elements">
                <div class="floating-coin">🪙</div>
                <div class="floating-coin">🚇</div>
                <div class="floating-coin">⭐</div>
                <div class="floating-coin">🎮</div>
                <div class="floating-coin">🏆</div>
            </div>
        </div>
    </div>

    <!-- Main Game Interface -->
    <div id="start-screen" style="display: none;">
        <!-- User Profile Header -->
        <div id="user-profile" class="user-profile">
            <div class="user-avatar" id="user-avatar">U</div>
            <div class="user-info">
                <h3 id="username-display">Guest Player</h3>
                <div class="user-stats">
                    <span>💾 <span id="save-status">Local Save</span></span>
                    <span>⚡ Online: <span id="connection-status">Offline</span></span>
                </div>
            </div>
            <button id="logout-btn" class="logout-btn" style="display: none;">
                <span>🚪</span> Uitloggen
            </button>
        </div>

    <!-- Update Log Panel -->
    <div id="update-log" class="side-panel">
        <div class="panel-header">
            <h3>📋 Update Log</h3>
            <button id="close-updates" class="close-btn">×</button>
        </div>
        <div class="panel-content">
            <div class="update-item latest">
                <div class="update-version">v3.0.0 - MEGA UPDATE!</div>
                <div class="update-date">23 Sep 2025</div>
                <ul>
                    <li>🎵 Complete geluidssysteem toegevoegd</li>
                    <li>✨ Particle effects & visual upgrades</li>
                    <li>⭐ Power-ups collectible systeem</li>
                    <li>🏆 Achievements & badges systeem</li>
                    <li>🌦️ Dynamic weather effects</li>
                    <li>⚙️ Settings menu met audio controls</li>
                    <li>📊 Enhanced statistics tracking</li>
                </ul>
            </div>
            <div class="update-item">
                <div class="update-version">v2.1.0</div>
                <div class="update-date">23 Sep 2025</div>
                <ul>
                    <li>🤖 Multiplayer VS Bots mode toegevoegd</li>
                    <li>👔 Outfit systeem met unieke powers</li>
                    <li>📺 Advertentie systeem voor gratis coins</li>
                    <li>🎨 Complete UI herontwerp</li>
                    <li>📊 Live ranking systeem</li>
                </ul>
            </div>
            <div class="update-item">
                <div class="update-version">v2.0.5</div>
                <div class="update-date">22 Sep 2025</div>
                <ul>
                    <li>⚡ Snellere character movement</li>
                    <li>🔔 In-game notification systeem</li>
                    <li>🎯 Verbeterde difficulty balancing</li>
                </ul>
            </div>
            <div class="update-item">
                <div class="update-version">v2.0.0</div>
                <div class="update-date">21 Sep 2025</div>
                <ul>
                    <li>🛒 Shop systeem met skins</li>
                    <li>🪙 Coin economy toegevoegd</li>
                    <li>🛡️ Automatisch schild systeem</li>
                    <li>🌈 5 unieke skins met abilities</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Main Game Interface -->
    <div id="start-screen">
        <div class="game-header">
            <h1>🚇 Subway Server Game 🚇</h1>
            <div class="version-badge">v3.0.0</div>
            <button id="show-updates" class="updates-btn">📋 Updates</button>
            <button id="settings-btn" class="settings-btn">⚙️ Settings</button>
        </div>

        <!-- Player Stats Dashboard -->
        <div id="player-dashboard">
            <div class="stat-card">
                <div class="stat-icon">🪙</div>
                <div class="stat-info">
                    <span class="stat-value" id="coin-display">0</span>
                    <span class="stat-label">Coins</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">👔</div>
                <div class="stat-info">
                    <span class="stat-value" id="active-outfit">Default</span>
                    <span class="stat-label">Outfit</span>
                </div>
            </div>
            <div class="stat-card ad-card" id="ad-section">
                <div class="stat-icon">📺</div>
                <div class="stat-info">
                    <button id="watch-ad-btn" class="ad-btn">Bekijk Ad</button>
                    <span class="stat-label">+10 Coins</span>
                </div>
            </div>
        </div>

        <!-- Enhanced Game Mode Selection -->
        <div id="gamemode-selection">
            <h3>🎮 Selecteer Game Mode</h3>
            <div class="gamemode-grid">
                <div class="gamemode-card" data-mode="infinity">
                    <div class="mode-icon">♾️</div>
                    <h4>Infinity Mode</h4>
                    <p>Endless runner met progressieve difficulty</p>
                    <div class="mode-stats">
                        <span>⭐ Best: <span id="infinity-best">0</span></span>
                    </div>
                    <button id="infinity-btn" class="mode-btn">Spelen</button>
                </div>

                <div class="gamemode-card" data-mode="level">
                    <div class="mode-icon">🎯</div>
                    <h4>Level Mode</h4>
                    <p>Gestructureerde levels met doelen</p>
                    <div class="mode-stats">
                        <span>🏆 Level: <span id="level-progress">1</span></span>
                    </div>
                    <button id="level-btn" class="mode-btn">Spelen</button>
                </div>

                <div class="gamemode-card" data-mode="multiplayer">
                    <div class="mode-icon">🤖</div>
                    <h4>VS Bots</h4>
                    <p>Compete tegen 4 AI tegenstanders</p>
                    <div class="mode-stats">
                        <span>🥇 Wins: <span id="multiplayer-wins">0</span></span>
                    </div>
                    <button id="multiplayer-btn" class="mode-btn multiplayer">Spelen</button>
                </div>
            </div>
        </div>

        <!-- Shop Access -->
        <div id="shop-access">
            <button id="shop-btn" class="main-shop-btn">
                <span class="shop-icon">🛒</span>
                <span>Outfits & Powers</span>
                <span class="shop-badge">NEW</span>
            </button>
        </div>

        <div class="quick-controls">
            <p>⌨️ Druk <kbd>Enter</kbd> voor Infinity Mode | <kbd>L</kbd> voor Level Mode | <kbd>M</kbd> voor
                Multiplayer</p>
        </div>

        <!-- New Features Section -->
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">🎵</div>
                <h4>Audio System</h4>
                <p>Dynamic sound effects and background music</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">⭐</div>
                <h4>Power-ups</h4>
                <p>Collect special abilities during gameplay</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">🏆</div>
                <h4>Achievements</h4>
                <p>Unlock badges and track your progress</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">🌦️</div>
                <h4>Weather Effects</h4>
                <p>Experience different environmental conditions</p>
            </div>
        </div>

        <div class="game-tips">
            <div class="tip-item">💡 <strong>Tip:</strong> Elke 1000 punten = 10 sec schild!</div>
            <div class="tip-item">⭐ <strong>Nieuw:</strong> Verzamel power-ups voor speciale abilities!</div>
            <div class="tip-item">� <strong>Nieuw:</strong> Unlock achievements voor bonussen!</div>
        </div>
    </div>

    <!-- Settings Screen -->
    <div id="settings-screen" style="display:none;">
        <div class="settings-header">
            <h2>⚙️ Game Settings</h2>
            <button id="settings-close-btn" class="settings-close">×</button>
        </div>

        <div class="settings-content">
            <div class="settings-section">
                <h3>🎵 Audio Settings</h3>
                <div class="setting-item">
                    <label>Master Volume</label>
                    <input type="range" id="master-volume" min="0" max="100" value="50">
                    <span id="master-volume-value">50%</span>
                </div>
                <div class="setting-item">
                    <label>Sound Effects</label>
                    <input type="range" id="effects-volume" min="0" max="100" value="70">
                    <span id="effects-volume-value">70%</span>
                </div>
                <div class="setting-item">
                    <label>Background Music</label>
                    <input type="range" id="music-volume" min="0" max="100" value="30">
                    <span id="music-volume-value">30%</span>
                </div>
                <div class="setting-item">
                    <label>Mute All Sounds</label>
                    <input type="checkbox" id="mute-toggle">
                </div>
            </div>

            <div class="settings-section">
                <h3>🎮 Gameplay Settings</h3>
                <div class="setting-item">
                    <label>Particle Effects</label>
                    <input type="checkbox" id="particles-toggle" checked>
                </div>
                <div class="setting-item">
                    <label>Weather Effects</label>
                    <input type="checkbox" id="weather-toggle" checked>
                </div>
                <div class="setting-item">
                    <label>Screen Shake</label>
                    <input type="checkbox" id="shake-toggle" checked>
                </div>
            </div>

            <div class="settings-section">
                <h3>📊 Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-display">
                        <span class="stat-icon">🪙</span>
                        <div class="stat-info">
                            <span class="stat-label">Total Coins</span>
                            <span class="stat-value" id="total-coins-stat">0</span>
                        </div>
                    </div>
                    <div class="stat-display">
                        <span class="stat-icon">👻</span>
                        <div class="stat-info">
                            <span class="stat-label">Ghost Uses</span>
                            <span class="stat-value" id="ghost-uses-stat">0</span>
                        </div>
                    </div>
                    <div class="stat-display">
                        <span class="stat-icon">⭐</span>
                        <div class="stat-info">
                            <span class="stat-label">Power-ups</span>
                            <span class="stat-value" id="powerups-stat">0</span>
                        </div>
                    </div>
                    <div class="stat-display">
                        <span class="stat-icon">⏰</span>
                        <div class="stat-info">
                            <span class="stat-label">Best Survival</span>
                            <span class="stat-value" id="survival-stat">0s</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <h3>🏆 Achievements</h3>
                <div class="achievements-grid" id="achievements-list">
                    <!-- Achievements will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Daily Challenge Popup -->
    <div id="challenge-popup" class="modal" style="display:none;">
        <div class="modal-content challenge-content">
            <h3>🎯 Daily Challenge</h3>
            <div id="challenge-details">
                <div class="challenge-icon">🏃</div>
                <h4 id="challenge-title">Loading...</h4>
                <p id="challenge-description">Loading challenge...</p>
                <div class="challenge-progress">
                    <div class="progress-bar">
                        <div id="challenge-progress-fill" class="progress-fill"></div>
                    </div>
                    <span id="challenge-progress-text">0/100</span>
                </div>
                <div class="challenge-reward">
                    Reward: <span id="challenge-reward">50 Coins</span>
                </div>
            </div>
            <button id="challenge-close-btn" class="challenge-btn">Close</button>
        </div>
    </div>

    <!-- Enhanced Shop Screen -->
    <div id="shop-screen" style="display:none;">
        <div class="shop-header">
            <h2>🛒 Outfits & Powers Store</h2>
            <button id="shop-close-btn" class="shop-close">×</button>
        </div>

        <div class="shop-tabs">
            <button class="shop-tab active" data-tab="outfits">👔 Outfits</button>
            <button class="shop-tab" data-tab="powers">⚡ Powers</button>
            <button class="shop-tab" data-tab="boosts">🚀 Boosts</button>
        </div>

        <!-- Outfits Tab -->
        <div id="outfits-tab" class="shop-tab-content active">
            <div class="shop-grid">
                <div class="outfit-item" data-item="goldenSkin">
                    <div class="outfit-preview golden-preview"></div>
                    <h3>✨ Golden Suit</h3>
                    <p>+25% coin bonus</p>
                    <div class="rarity legendary">Legendary</div>
                    <div class="price">🪙 100</div>
                    <button class="buy-btn" data-item="goldenSkin">Koop</button>
                </div>

                <div class="outfit-item" data-item="speedSkin">
                    <div class="outfit-preview speed-preview"></div>
                    <h3>💨 Speed Demon</h3>
                    <p>50% snellere movement</p>
                    <div class="rarity epic">Epic</div>
                    <div class="price">🪙 150</div>
                    <button class="buy-btn" data-item="speedSkin">Koop</button>
                </div>

                <div class="outfit-item" data-item="ghostSkin">
                    <div class="outfit-preview ghost-preview"></div>
                    <h3>👻 Ghost Walker</h3>
                    <p>Fase door obstacles</p>
                    <div class="rarity legendary">Legendary</div>
                    <div class="price">🪙 200</div>
                    <button class="buy-btn" data-item="ghostSkin">Koop</button>
                </div>

                <div class="outfit-item" data-item="tankSkin">
                    <div class="outfit-preview tank-preview"></div>
                    <h3>🛡️ Tank Armor</h3>
                    <p>2 extra levens per run</p>
                    <div class="rarity epic">Epic</div>
                    <div class="price">🪙 300</div>
                    <button class="buy-btn" data-item="tankSkin">Koop</button>
                </div>

                <div class="outfit-item" data-item="rainbowSkin">
                    <div class="outfit-preview rainbow-preview"></div>
                    <h3>🌈 Rainbow Master</h3>
                    <p>Alle abilities gecombineerd!</p>
                    <div class="rarity mythic">Mythic</div>
                    <div class="price">🪙 500</div>
                    <button class="buy-btn" data-item="rainbowSkin">Koop</button>
                </div>

                <div class="outfit-item" data-item="neonSkin">
                    <div class="outfit-preview neon-preview"></div>
                    <h3>⚡ Neon Racer</h3>
                    <p>Glow effect + 2x score</p>
                    <div class="rarity legendary">Legendary</div>
                    <div class="price">🪙 400</div>
                    <button class="buy-btn" data-item="neonSkin">Koop</button>
                </div>
            </div>
        </div>

        <!-- Powers Tab -->
        <div id="powers-tab" class="shop-tab-content">
            <div class="shop-grid">
                <div class="power-item" data-item="doubleJump">
                    <div class="power-icon">🦘</div>
                    <h3>Double Jump</h3>
                    <p>Spring over 2 obstacles</p>
                    <div class="price">🪙 75</div>
                    <button class="buy-btn" data-item="doubleJump">Koop</button>
                </div>

                <div class="power-item" data-item="timeSlower">
                    <div class="power-icon">⏰</div>
                    <h3>Time Slower</h3>
                    <p>Vertraag tijd 5 seconden</p>
                    <div class="price">🪙 120</div>
                    <button class="buy-btn" data-item="timeSlower">Koop</button>
                </div>

                <div class="power-item" data-item="coinRain">
                    <div class="power-icon">💰</div>
                    <h3>Coin Rain</h3>
                    <p>Instant 50 coins per gebruik</p>
                    <div class="price">🪙 90</div>
                    <button class="buy-btn" data-item="coinRain">Koop</button>
                </div>

                <div class="power-item" data-item="megaShield">
                    <div class="power-icon">🛡️</div>
                    <h3>Mega Shield</h3>
                    <p>30 seconden onkwetsbaar</p>
                    <div class="price">🪙 200</div>
                    <button class="buy-btn" data-item="megaShield">Koop</button>
                </div>
            </div>
        </div>

        <!-- Boosts Tab -->
        <div id="boosts-tab" class="shop-tab-content">
            <div class="shop-grid">
                <div class="boost-item" data-item="speed">
                    <div class="boost-icon">⚡</div>
                    <h3>Speed Boost</h3>
                    <p>20% sneller starten</p>
                    <div class="price">🪙 10</div>
                    <button class="buy-btn" data-item="speed">Koop</button>
                </div>

                <div class="boost-item" data-item="shield">
                    <div class="boost-icon">🛡️</div>
                    <h3>Extra Shield</h3>
                    <p>+1 leven per run</p>
                    <div class="price">🪙 25</div>
                    <button class="buy-btn" data-item="shield">Koop</button>
                </div>

                <div class="boost-item" data-item="magnet">
                    <div class="boost-icon">🧲</div>
                    <h3>Coin Magnet</h3>
                    <p>2x meer coins</p>
                    <div class="price">🪙 50</div>
                    <button class="buy-btn" data-item="magnet">Koop</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ad Modal -->
    <div id="ad-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <h3>📺 Gratis Coins Advertentie</h3>
            <div class="ad-placeholder">
                <p>🎬 Advertentie wordt afgespeeld...</p>
                <div class="ad-timer">
                    <div id="ad-progress" class="progress-bar"></div>
                    <span id="ad-countdown">5</span> seconden
                </div>
            </div>
            <button id="ad-claim-btn" class="ad-claim" disabled>Claim 10 Coins</button>
            <button id="ad-close-btn" class="modal-close">×</button>
        </div>
    </div>

    <div id="game-info" style="display:none;">
        <div id="game-stats">
            <span id="mode-display"></span>
            <span id="level-display"></span>
            <div id="coins-ingame">🪙 <span id="coins-count">0</span></div>
        </div>
    </div>
    <canvas id="game-canvas" width="480" height="640" style="display:none;"></canvas>
    <script src="game.js"></script>
</body>

</html>